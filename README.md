# MBON_methods_experiment
These scripts are for processing the OTU_table file generated by banzai pipeline (https://github.com/jimmyodonnell/banzai). They are compatible for all target loci (e.g. 12S, 16S, 18S, 28S). The scripts include (in order of processing): 

1. Species occupancy modeling. This script was developed by Lahoz-Monfort et al. 2015 (http://onlinelibrary.wiley.com/doi/10.1111/1755-0998.12486/abstract) and modified for use with banzai pipeline output by Ryan Kelly. This Bayesian framework accounts for false-positive errors in eDNA sequence data resulting from PCR errors, sequencing errors, low-level noise, etc.

2. MBON methods experiment processing. This script takes the OTU generated by the banzai pipeline (or modified OTU table output by the species occupancy modeling script) and runs the following steps:
        1. Removal of contaminant reads identified by positive and/or negative controls
        2. Removal of OTUs assigned as 'no hits' via BLAST
        3. Data normalization with DESeq2
        4. Data analyses and plots
            a. Species richness
            b. Multiple linear regression
            c. NMDS/hierarchical clustering

3. Annotate OTU table. This script takes an OTU_table along with the taxonomic assignments from MEGAN (which runs the LCA algorithm on BLAST results) and converts the OTU table to a taxon table. The taxon table shows sequence counts per taxon per sample. The scripts above can also be re-run at the taxon as opposed to OTU level. To do so the OTU table generated by banzai must be first converted to a taxon table using this script.
